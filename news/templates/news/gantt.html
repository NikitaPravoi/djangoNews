{% extends 'news/base.html' %}
{% block scripts %}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/frappe-gantt/0.6.1/frappe-gantt.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/frappe-gantt/0.6.1/frappe-gantt.css">
{% endblock %}
  {% block style %}
        body {
            background: white;
        }

        .nw-header {
            position: absolute;
        }

        .main {
            width: 100%;
        }
    {% endblock %}
{% block content %}
  <div class="chart-controls text-center">
    <h5>Изменить вид</h5>
    <div style="margin-bottom: 15px" class="button-cont text-center btn-group-justified">

        <button class="btn btn-light text-dark me-2" id="day-btn">
            День
        </button>

        <button class="btn btn-light text-dark me-2" id="week-btn">
            Неделя
        </button>

        <button class="btn btn-light text-dark me-2" id="month-btn">
            Месяц
        </button>
    </div>
  </div>
  <div id="gantt"></div>

  <script>
      var tasks = [
          {
                id: 'Task 1',
                name: 'Проектирование системы',
                start: '2023-04-17',
                end: '2023-06-04',
                progress: 100,
                dependencies: '',
                custom_class: 'bar-milestone' // optional
              },
              {
                id: 'Task 2',
                name: 'Сбор исходных данных (План)',
                start: '2023-04-17',
                end: '2023-05-07',
                progress: 0,
                dependencies: '',
                custom_class: 'bar-milestone' // optional
              },
                {
                id: 'Task 2',
                name: 'Сбор исходных данных (Факт)',
                start: '2023-04-17',
                end: '2023-05-28',
                progress: 100,
                dependencies: '',
                custom_class: 'bar-milestone' // optional
              },
            {
                id: 'Task 3',
                name: 'Изучение исходных данных (План)',
                start: '2023-04-24',
                end: '2023-05-14',
                progress: 0,
                dependencies: 'Task 1',
                custom_class: 'bar-milestone' // optional
              },
            {
                id: 'Task 3',
                name: 'Изучение исходных данных (Факт)',
                start: '2023-04-24',
                end: '2023-05-21',
                progress: 100,
                dependencies: 'Task 1',
                custom_class: 'bar-milestone' // optional
              },
            {
                id: 'Task 4',
                name: 'Проектирование схемы бизнес-процессов (План)',
                start: '2023-05-15',
                end: '2023-06-04',
                progress: 0,
                dependencies: 'Task 1',
                custom_class: 'bar-milestone' // optional
              },
            {
                id: 'Task 4',
                name: 'Проектирование схемы бизнес-процессов (Факт)',
                start: '2023-05-08',
                end: '2023-06-18',
                progress: 100,
                dependencies: 'Task 1',
                custom_class: 'bar-milestone' // optional
              },
            {
                id: 'Task 4',
                name: 'Разработка ролевой модели (План)',
                start: '2023-05-08',
                end: '2023-05-14',
                progress: 0,
                dependencies: 'Task 1',
                custom_class: 'bar-milestone' // optional
              },
            {
                id: 'Task 4',
                name: 'Разработка ролевой модели (Факт)',
                start: '2023-05-15',
                end: '2023-05-21',
                progress: 100,
                dependencies: 'Task 1',
                custom_class: 'bar-milestone' // optional
              },
          {
                id: 'Task 4',
                name: 'Проектирование системы (План)',
                start: '2023-05-08',
                end: '2023-05-14',
                progress: 0,
                dependencies: 'Task 1',
                custom_class: 'bar-milestone' // optional
              },
            {
                id: 'Task 4',
                name: 'Проектирование системы (Факт)',
                start: '2023-05-15',
                end: '2023-06-04',
                progress: 100,
                dependencies: 'Task 1',
                custom_class: 'bar-milestone' // optional
              },
            {
                id: 'Task 5',
                name: 'Разработка базовых модулей',
                start: '2023-05-29',
                end: '2023-07-16',
                progress: 70,
                dependencies: '',
                custom_class: 'bar-milestone' // optional
              },
            {
                id: 'Task 6',
                name: 'Разработка общей среды функциональной системы (План)',
                start: '2023-06-05',
                end: '2023-06-25',
                progress: 0,
                dependencies: 'Task 5',
                custom_class: 'bar-milestone' // optional
              },
            {
                id: 'Task 6',
                name: 'Разработка общей среды функциональной системы (Факт)',
                start: '2023-05-08',
                end: '2023-06-19',
                progress: 90,
                dependencies: 'Task 5',
                custom_class: 'bar-milestone' // optional
              },
            {
                id: 'Task 6',
                name: 'Разработка интерфейса (План)',
                start: '2023-06-05',
                end: '2023-06-25',
                progress: 0,
                dependencies: 'Task 5',
                custom_class: 'bar-milestone' // optional
              },
            {
                id: 'Task 6',
                name: 'Разработка интерфейса (Факт)',
                start: '2023-05-08',
                end: '2023-06-19',
                progress: 85,
                dependencies: 'Task 5',
                custom_class: 'bar-milestone' // optional
              },
            {
                id: 'Task 6',
                name: 'Разработка реестра показателей и аттрибутов (План)',
                start: '2023-06-05',
                end: '2023-06-25',
                progress: 0,
                dependencies: 'Task 5',
                custom_class: 'bar-milestone' // optional
              },
            {
                id: 'Task 6',
                name: 'Разработка реестра показателей и аттрибутов (Факт)',
                start: '2023-05-22',
                end: '2023-06-19',
                progress: 85,
                dependencies: 'Task 5',
                custom_class: 'bar-milestone' // optional
              },
            {
                id: 'Task 6',
                name: 'Разработка базы данных (План)',
                start: '2023-06-05',
                end: '2023-06-25',
                progress: 0,
                dependencies: 'Task 5',
                custom_class: 'bar-milestone' // optional
              },
            {
                id: 'Task 6',
                name: 'Разработка базы данных (Факт)',
                start: '2023-05-08',
                end: '2023-05-28',
                progress: 100,
                dependencies: 'Task 5',
                custom_class: 'bar-milestone' // optional
              },
            {
                id: 'Task 6',
                name: 'Разработка функциональных модулей (приложение) (План)',
                start: '2023-06-05',
                end: '2023-07-09',
                progress: 0,
                dependencies: 'Task 5',
                custom_class: 'bar-milestone' // optional
              },
            {
                id: 'Task 6',
                name: 'Разработка функциональных модулей (приложение) (Факт)',
                start: '2023-05-15',
                end: '2023-06-25',
                progress: 90,
                dependencies: 'Task 5',
                custom_class: 'bar-milestone' // optional
              },
          {
                id: 'Task 6',
                name: 'Интеграция системы с Oracle Primavera (План)',
                start: '2023-05-29',
                end: '2023-07-16',
                progress: 0,
                dependencies: 'Task 5',
                custom_class: 'bar-milestone' // optional
              },
            ]
            var gantt = new Gantt("#gantt", tasks, {
                header_height: 50,
                column_width: 30,
                step: 24,
                view_modes: ['Quarter Day', 'Half Day', 'Day', 'Week', 'Month'],
                bar_height: 20,
                bar_corner_radius: 3,
                arrow_curve: 5,
                padding: 18,
                view_mode: 'Week',
                date_format: 'YYYY-MM-DD',
                language: 'ru',
                custom_popup_html: function(task) {
                        return `
                          <div class="details-container">
                            <h6>${task.name}</h6>
                            <p>Начало: ${task._start.getDate()}</p>
                            <p>Ожидаемая дата окончания: ${task._end.getDate()}</p>
                            <p>${task.progress}% завершено</p>
                            <p>Комментарий: ${task.custom_class}</p>
                          </div>
                        `;
                }
            });
      document.querySelector("#day-btn").addEventListener("click", () => {
        gantt.change_view_mode("Day");
        })
        document.querySelector("#week-btn").addEventListener("click", () => {
            gantt.change_view_mode("Week");
        })
        document.querySelector("#month-btn").addEventListener("click", () => {
            gantt.change_view_mode("Month");
        })
  </script>
{% endblock %}
                